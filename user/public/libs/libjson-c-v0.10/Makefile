# Makefile.in generated by automake 1.10 from Makefile.am.
# Makefile.  Generated from Makefile.in by configure.

# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
# This Makefile.in is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.


CFLAGS = -Wall -std=gnu99 -D_GNU_SOURCE -D_REENTRANT
CFLAGS += -Os -Wall -s -fPIC
EXEC = test1 test2 test4 test5 test_cast test_null test_parse_int64

LIBNAME = libjson.so

HEADERS = \
		  json.h \
		  bits.h \
		  debug.h \
		  linkhash.h \
		  arraylist.h \
		  json_util.h \
		  json_object.h \
		  json_tokener.h

SOURCES = arraylist.c \
	debug.c \
	json_object.c \
	json_tokener.c \
	json_util.c \
	linkhash.c \
	printbuf.c

OBJS =  arraylist.o \
	debug.o \
	json_object.o \
	json_tokener.o \
	json_util.o \
	linkhash.o \
	printbuf.o

test1_SOURCES = test1.c
test1_LDADD = $(lib_LTLIBRARIES)
test2_SOURCES = test2.c
test2_LDADD = $(lib_LTLIBRARIES)
test2_SOURCES = test4.c
test2_LDADD = $(lib_LTLIBRARIES)

all: $(LIBNAME)

install:
	$(STRIP) $(LIBNAME)
	cp -f $(LIBNAME) $(INSTALLDIR)/lib

%.o: %.c   
	$(CC) $(CFLAGS)  -c $^ 

$(LIBNAME): $(OBJS)
#   $(AR) -cr $@ $^
	$(CC) -Os -s -shared -fPIC  -o $@ -Wl,-soname,$@ $(OBJS)

clean:
	rm -f *.o $(EXEC) $(LIBNAME) $(OBJS)

test:  
	$(CC) $(CFLAGS) -c test1.c
	$(CC) $(CFLAGS) -o test1 test1.o libjson.so 
	$(CC) $(CFLAGS) -c test2.c
	$(CC) $(CFLAGS) -o test2 test2.o libjson.so 
	$(CC) $(CFLAGS) -c test4.c
	$(CC) $(CFLAGS) -o test4 test4.o libjson.so 
	$(CC) $(CFLAGS) -c test5.c
	$(CC) $(CFLAGS) -o test5 test5.o libjson.so 
	$(CC) $(CFLAGS) -c test_cast.c
	$(CC) $(CFLAGS) -o test_cast test_cast.o libjson.so 
	$(CC) $(CFLAGS) -c test_null.c
	$(CC) $(CFLAGS) -o test_null test_null.o libjson.so 
	$(CC) $(CFLAGS) -c test_parse_int64.c
	$(CC) $(CFLAGS) -o test_parse_int64 test_parse_int64.o libjson.so 




